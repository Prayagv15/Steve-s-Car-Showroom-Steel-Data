# Steve's-Car-Showroom-Steel-Data

**Schema (MySQL v5.7)**

    CREATE TABLE cars (
    car_id INT PRIMARY KEY,
    make VARCHAR(50),
    type VARCHAR(50),
    style VARCHAR(50),
    cost_$ INT
    );
    
    INSERT INTO cars (car_id, make, type, style, cost_$)
    VALUES (1, 'Honda', 'Civic', 'Sedan', 30000),
    (2, 'Toyota', 'Corolla', 'Hatchback', 25000),
    (3, 'Ford', 'Explorer', 'SUV', 40000),
    (4, 'Chevrolet', 'Camaro', 'Coupe', 36000),
    (5, 'BMW', 'X5', 'SUV', 55000),
    (6, 'Audi', 'A4', 'Sedan', 48000),
    (7, 'Mercedes', 'C-Class', 'Coupe', 60000),
    (8, 'Nissan', 'Altima', 'Sedan', 26000);
    
    
    CREATE TABLE salespersons (
    salesman_id INT PRIMARY KEY,
    name VARCHAR(50),
    age INT,
    city VARCHAR(50)
    );
    
    INSERT INTO salespersons (salesman_id, name, age, city)
    VALUES (1, 'John Smith', 28, 'New York'),
    (2, 'Emily Wong', 35, 'San Fran'),
    (3, 'Tom Lee', 42, 'Seattle'),
    (4, 'Lucy Chen', 31, 'LA');
    
    CREATE TABLE sales (
    sale_id INT PRIMARY KEY,
    car_id INT,
    salesman_id INT,
    purchase_date DATE,
    FOREIGN KEY (car_id) REFERENCES cars(car_id),
    FOREIGN KEY (salesman_id) REFERENCES salespersons(salesman_id)
    );
    
    INSERT INTO sales (sale_id, car_id, salesman_id, purchase_date)
    VALUES (1, 1, 1, '2021-01-01'),
    (2, 3, 3, '2021-02-03'),
    (3, 2, 2, '2021-02-10'),
    (4, 5, 4, '2021-03-01'),
    (5, 8, 1, '2021-04-02'),
    (6, 2, 1, '2021-05-05'),
    (7, 4, 2, '2021-06-07'),
    (8, 5, 3, '2021-07-09'),
    (9, 2, 4, '2022-01-01'),
    (10, 1, 3, '2022-02-03'),
    (11, 8, 2, '2022-02-10'),
    (12, 7, 2, '2022-03-01'),
    (13, 5, 3, '2022-04-02'),
    (14, 3, 1, '2022-05-05'),
    (15, 5, 4, '2022-06-07'),
    (16, 1, 2, '2022-07-09'),
    (17, 2, 3, '2023-01-01'),
    (18, 6, 3, '2023-02-03'),
    (19, 7, 1, '2023-02-10'),
    (20, 4, 4, '2023-03-01');
    
    
    

---

**Query #1: What are the details of all cars purchased in the year 2022?**
	
    SELECT 
        c.make,
        c.type,
        c.style,
        c.cost_$ AS Cost,
        YEAR(s.purchase_date) AS 'Purchased Year'
    FROM
        cars AS c
            INNER JOIN
        sales AS s ON c.car_id = s.car_id
    WHERE
        YEAR(s.purchase_date) = 2022;

| make     | type     | style     | Cost  | Purchased Year |
| -------- | -------- | --------- | ----- | -------------- |
| Toyota   | Corolla  | Hatchback | 25000 | 2022           |
| Honda    | Civic    | Sedan     | 30000 | 2022           |
| Nissan   | Altima   | Sedan     | 26000 | 2022           |
| Mercedes | C-Class  | Coupe     | 60000 | 2022           |
| BMW      | X5       | SUV       | 55000 | 2022           |
| Ford     | Explorer | SUV       | 40000 | 2022           |
| BMW      | X5       | SUV       | 55000 | 2022           |
| Honda    | Civic    | Sedan     | 30000 | 2022           |

---
**Query #2: What is the total number of cars sold by each salesperson?**

    SELECT 
        sp.name, COUNT(s.sale_id) AS Cars_sold
    FROM
        sales AS s
            JOIN
        salespersons AS sp ON s.salesman_id = sp.salesman_id
    GROUP BY sp.name
    ORDER BY Cars_sold DESC;

| name       | Cars_sold |
| ---------- | --------- |
| Tom Lee    | 6         |
| John Smith | 5         |
| Emily Wong | 5         |
| Lucy Chen  | 4         |

---
**Query #3: What is the total revenue generated by each salesperson?**

    SELECT 
        sp.name, SUM(c.cost_$) AS Total_Revenue
    FROM
        cars AS c
            INNER JOIN
        sales AS s ON s.car_id = c.car_id
            INNER JOIN
        salespersons AS sp ON sp.salesman_id = s.salesman_id
    GROUP BY sp.name
    ORDER BY Total_Revenue DESC;

| name       | Total_Revenue |
| ---------- | ------------- |
| Tom Lee    | 253000        |
| John Smith | 181000        |
| Emily Wong | 177000        |
| Lucy Chen  | 171000        |

---
**Query #4: What are the details of the cars sold by each salesperson?**

    SELECT 
        sp.name, c.make, c.type, c.style
    FROM
        cars AS c
            INNER JOIN
        sales AS s ON s.car_id = c.car_id
            INNER JOIN
        salespersons AS sp ON sp.salesman_id = s.salesman_id
    GROUP BY sp.name , c.make , c.type , c.style;

| name       | make      | type     | style     |
| ---------- | --------- | -------- | --------- |
| Emily Wong | Chevrolet | Camaro   | Coupe     |
| Emily Wong | Honda     | Civic    | Sedan     |
| Emily Wong | Mercedes  | C-Class  | Coupe     |
| Emily Wong | Nissan    | Altima   | Sedan     |
| Emily Wong | Toyota    | Corolla  | Hatchback |
| John Smith | Ford      | Explorer | SUV       |
| John Smith | Honda     | Civic    | Sedan     |
| John Smith | Mercedes  | C-Class  | Coupe     |
| John Smith | Nissan    | Altima   | Sedan     |
| John Smith | Toyota    | Corolla  | Hatchback |
| Lucy Chen  | BMW       | X5       | SUV       |
| Lucy Chen  | Chevrolet | Camaro   | Coupe     |
| Lucy Chen  | Toyota    | Corolla  | Hatchback |
| Tom Lee    | Audi      | A4       | Sedan     |
| Tom Lee    | BMW       | X5       | SUV       |
| Tom Lee    | Ford      | Explorer | SUV       |
| Tom Lee    | Honda     | Civic    | Sedan     |
| Tom Lee    | Toyota    | Corolla  | Hatchback |

---
**Query #5: What is the total revenue generated by each car type?**

    SELECT 
        c.type AS 'Car Type', SUM(c.cost_$) AS Revenue
    FROM
        cars AS c
            INNER JOIN
        sales AS s ON c.car_id = s.car_id
    GROUP BY c.type
    ORDER BY Revenue DESC;

| Car Type | Revenue |
| -------- | ------- |
| X5       | 220000  |
| C-Class  | 120000  |
| Corolla  | 100000  |
| Civic    | 90000   |
| Explorer | 80000   |
| Camaro   | 72000   |
| Altima   | 52000   |
| A4       | 48000   |

---
**Query #6: What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?**

    SELECT 
        sp.name, c.make, c.type, c.style, c.cost_$ AS Cost
    FROM
        cars AS c
            INNER JOIN
        sales AS s ON s.car_id = c.car_id
            INNER JOIN
        salespersons AS sp ON sp.salesman_id = s.salesman_id
    WHERE
        sp.name = 'Emily Wong'
            AND YEAR(s.purchase_date) = 2021;

| name       | make      | type    | style     | Cost  |
| ---------- | --------- | ------- | --------- | ----- |
| Emily Wong | Toyota    | Corolla | Hatchback | 25000 |
| Emily Wong | Chevrolet | Camaro  | Coupe     | 36000 |

---
**Query #7: What is the total revenue generated by the sales of hatchback cars?**

    SELECT 
        SUM(c.cost_$) AS 'Total Revenue'
    FROM
        cars AS c
            INNER JOIN
        cars AS cc ON c.car_id = cc.car_id
            INNER JOIN
        sales AS s ON c.car_id = s.car_id
    WHERE
        c.style = 'Hatchback';

| Total Revenue |
| ------------- |
| 100000        |

---
**Query #8: What is the total revenue generated by the sales of SUV cars in the year 2022?**

    SELECT 
        c.style AS 'Style: SUV', SUM(c.cost_$) AS 'Total Revenue'
    FROM
        cars AS c
            INNER JOIN
        cars AS cc ON c.car_id = cc.car_id
            INNER JOIN
        sales AS s ON c.car_id = s.car_id
    WHERE
        c.style = 'SUV'
            AND YEAR(s.purchase_date) = 2022;

| Style: SUV | Total Revenue |
| ---------- | ------------- |
| SUV        | 150000        |

---
**Query #9: To know the salesperson and there sales count in the Year 2023.**

    select sp.name as Name,sp.city as City,purchase_date as Date,count(*) as "Total Sales" from sales as s
    inner join salespersons as sp
    on s.salesman_id=sp.salesman_id
    where Year(purchase_date)=2023
    group by Date,sp.name,sp.city
    order by "Total Sales";

| Name       | City     | Date       | Total Sales |
| ---------- | -------- | ---------- | ----------- |
| Tom Lee    | Seattle  | 2023-01-01 | 1           |
| Tom Lee    | Seattle  | 2023-02-03 | 1           |
| John Smith | New York | 2023-02-10 | 1           |
| Lucy Chen  | LA       | 2023-03-01 | 1           |

---
**Query #10: What is the name and city of the salesperson who sold the most number of cars in the year 2023?**

    SELECT 
        sp.name, sp.city, COUNT(*) AS Total_Sales
    FROM
        sales AS s
            INNER JOIN
        salespersons AS sp ON s.salesman_id = sp.salesman_id
    WHERE
        YEAR(s.purchase_date) = 2023
    GROUP BY sp.name , sp.city
    ORDER BY Total_Sales DESC
    LIMIT 1;

| name    | city    | Total_Sales |
| ------- | ------- | ----------- |
| Tom Lee | Seattle | 2           |

---
**Query #11: What is the name,city and age of the salesperson who generated the highest revenue in the year 2022?**

    SELECT 
        sp.name AS Name, sp.city AS City,sp.age,SUM(c.cost_$) AS 'Revenue'
    FROM
        cars AS c
            INNER JOIN
        sales AS s ON s.car_id = c.car_id
            INNER JOIN
        salespersons AS sp ON s.salesman_id = sp.salesman_id
    WHERE
        YEAR(purchase_date) = 2022
    GROUP BY sp.name , sp.city,sp.age
    ORDER BY Revenue DESC
    LIMIT 1;

| Name       | City     | age | Revenue |
| ---------- | -------- | --- | ------- |
| Emily Wong | San Fran | 35  | 116000  |


---
**Query #12: Query for the sales made by each Sales-person in the Year 2022.**
WITH cte AS 
    (
        SELECT 
            sp.name, s.purchase_date, c.cost_$ AS cost
        FROM
            salespersons AS sp
        INNER JOIN
            sales AS s ON s.salesman_id = sp.salesman_id
        INNER JOIN
            cars AS c ON c.car_id = s.car_id
      where Year(purchase_date)=2022
    )
    SELECT distinct(name),sum(cost) over (partition by name) as `Revenue in the Year: 2022` FROM cte;

| name       | Revenue in the Year: 2022 |
| ---------- | ------------------------- |
| Emily Wong | 116000                    |
| John Smith | 40000                     |
| Lucy Chen  | 80000                     |
| Tom Lee    | 85000                     |

---

[View on DB Fiddle](https://www.db-fiddle.com/f/coy9uYB62o8evTt4fH3xeG/1)

---

[View on DB Fiddle](https://www.db-fiddle.com/f/oYJeqUFEQpAjCHzPn7dDuB/1)
